authentik:
  secret_key: "" # Will be set via environment variable from secret
  error_reporting:
    enabled: false

global:
  env:
    - name: AUTHENTIK_SECRET_KEY
      valueFrom:
        secretKeyRef:
          name: authentik-secrets
          key: secret-key
    - name: AUTHENTIK_BOOTSTRAP_PASSWORD
      valueFrom:
        secretKeyRef:
          name: authentik-secrets
          key: bootstrap-password
    - name: AUTHENTIK_BOOTSTRAP_TOKEN
      valueFrom:
        secretKeyRef:
          name: authentik-secrets
          key: bootstrap-token
    - name: AUTHENTIK_BOOTSTRAP_EMAIL
      valueFrom:
        secretKeyRef:
          name: authentik-secrets
          key: bootstrap-email
    # PostgreSQL connection (Main CNPG cluster)
    - name: AUTHENTIK_POSTGRESQL__HOST
      value: postgresql-rw.postgresql.svc.cluster.local
    - name: AUTHENTIK_POSTGRESQL__NAME
      value: authentik
    - name: AUTHENTIK_POSTGRESQL__USER
      value: app
    - name: AUTHENTIK_POSTGRESQL__PASSWORD
      valueFrom:
        secretKeyRef:
          name: postgresql-app-credentials
          key: password

server:
  replicas: 2
  resources:
    requests:
      cpu: 100m
      memory: 512Mi
    limits:
      memory: 1Gi

worker:
  replicas: 2
  resources:
    requests:
      cpu: 100m
      memory: 512Mi
    limits:
      memory: 1Gi

# Disable embedded PostgreSQL - using CNPG instead
postgresql:
  enabled: false

# Embedded Redis
redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: false
  image:
    registry: docker.io
    repository: bitnami/redis
    tag: latest
  master:
    resources:
      requests:
        cpu: 25m
        memory: 64Mi
      limits:
        memory: 128Mi
